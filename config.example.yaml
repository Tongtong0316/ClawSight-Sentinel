# Sentinel é…ç½®å‚æ•° (Configuration Guide)

æœ¬ç³»ç»Ÿæ”¯æŒé€šè¿‡ YAML é…ç½®æ–‡ä»¶æˆ– WebUI è¿›è¡Œæ·±åº¦å®šåˆ¶ã€‚

## 1. æ ¸å¿ƒæ€§èƒ½è®¾ç½® (Performance)

```yaml
system:
  # CPU æ ¸å¿ƒäº²å’Œæ€§è®¾ç½® (PVE/N305 ä¸“ç”¨)
  cpu_affinity:
    # å¼ºåˆ¶ Sentinel ç³»ç»Ÿä»…ä½¿ç”¨ç‰¹å®šçš„ CPU æ ¸å¿ƒ
    # ä¿ç•™æ ¸å¿ƒ 0-3 ç»™ OpenWrt NAT ä½¿ç”¨ï¼Œæ¨è Sentinel ä½¿ç”¨ 4-7
    enabled: true
    cores: [4, 5, 6, 7] 

  # å†…å­˜ä¸èµ„æºé™åˆ¶
  resources:
    ollama:
      memory_limit: 3G
      # å¯é€‰æ¨¡å‹: deepseek-r1:1.5b, llama3:8b, phi3:mini
      default_model: "deepseek-r1:1.5b" 
```

## 2. å­˜å‚¨ä¸æ—¥å¿— (Storage)

```yaml
storage:
  # æ—¥å¿—å­˜å‚¨è·¯å¾„ (æ”¯æŒ TF å¡æŒ‚è½½ç‚¹)
  log_path: "/mnt/tf_card/sentinel_logs"
  
  # æ—¥å¿—ä¿ç•™ç­–ç•¥
  retention:
    days: 30          # ä¿ç•™å¤©æ•°
    max_size_gb: 28 # æœ€å¤§å ç”¨ç©ºé—´ (TF å¡æ¨è 32G)
  
  # æ—¥å¿—çº§åˆ«
  level: "info"     # debug, info, warn, error
```

## 3. æ— çº¿æ¥å…¥è®¾ç½® (WiFi Profiles)

```yaml
wifi:
  # æ— çº¿è®¾å¤‡é€‰æ‹© (ä¸é™äºä¸€ç§)
  interfaces:
    - name: "wlan0_monitor"
      driver: "rtl8812au"     # å½“å‰é©±åŠ¨: Realtek RTL8812AU
      mode: "monitor"          # ç›‘å¬æ¨¡å¼
      band: "5g"              # é¢‘æ®µ: 2.4g, 5g, both
      
    # é¢„ç•™: æ”¯æŒæ›´å¤š USB ç½‘å¡
    # - name: "wlan1_client"
    #   driver: "mt7601u"
    #   mode: "managed"
```

## 4. è‡ªåŠ¨åŒ–ä¸ä¿®å¤ (Automation)

```yaml
automation:
  # WebUI è‡ªåŠ¨åŒ–é…ç½®
  playwright:
    headless: true     # æ— å¤´æ¨¡å¼è¿è¡Œ
    timeout_ms: 30000
    
  # å±æœºä¿®å¤è„šæœ¬åº“
  scripts:
    - id: "openwrt_reboot"
      target: "http://192.168.0.40"
      credentials: "admin/password"
      actions: ["login", "system_reboot"]
      
    - id: "modem_recovery"
      target: "http://192.168.1.1"
      # ... å…‰çŒ«é…ç½®
```

## 5. æ¥å£ä¸å¤šè¯­è¨€ (i18n)

```yaml
ui:
  language: "zh-CN"   # æ”¯æŒ: zh-CN, en-US
  theme: "dark"       # dark, light
  
api:
  # Agent æ¥å£é…ç½®
  agent_token: "change_me_in_production"
```

---

## ğŸ“¡ Agent æ¥å…¥æŒ‡å—

ä»»ä½• AI Agent (å¦‚ Antigravity, OpenAI, Claude) å‡å¯é€šè¿‡ä»¥ä¸‹æµç¨‹æ¥å…¥ï¼š

### 1. å‘ç°ç³»ç»Ÿ (Bootstrap)
Agent å‘é€ GET è¯·æ±‚è‡³:
`http://<SENTINEL_IP>:8000/agent/bootstrap`

ç³»ç»Ÿå°†è¿”å›åŒ…å«ä»¥ä¸‹èƒ½åŠ›çš„ Markdown æŒ‡ä»¤é›†ï¼š
*   `GET /api/v1/logs` - è·å–æ—¥å¿—
*   `GET /api/v1/wifi/scan` - è·å– WiFi è´¨é‡æŠ¥å‘Š
*   `POST /api/v1/ai/diagnose` - æäº¤æ—¥å¿—ç‰‡æ®µè¿›è¡Œ AI è¯Šæ–­
*   `POST /api/v1/fix/{script_id}` - è§¦å‘è®¾å¤‡é‡å¯/æ¢å¤

### 2. è¯Šæ–­æµç¨‹
Agent åº”éµå¾ªä»¥ä¸‹æœ€ä½³å®è·µï¼š
1.  **Check WiFi Health**: å…ˆé€šè¿‡ `/wifi/scan` ç¡®è®¤ç‰©ç†å±‚æ˜¯å¦æœ‰å¹²æ‰°ã€‚
2.  **Fetch Logs**: è°ƒé˜…æœ€è¿‘çš„ `/logs`ï¼Œå¯»æ‰¾ `error` æˆ– `failed` å…³é”®å­—ã€‚
3.  **AI Inference**: å°†æ—¥å¿—ç‰‡æ®µ POST è‡³ `/ai/diagnose`ï¼Œç”±æœ¬åœ°å¤§æ¨¡å‹ç»™å‡ºä¸“ä¸šå»ºè®®ã€‚
4.  **Execute Fix**: å¦‚æœç¡®è®¤å±æœºä¸”æ— æ³• SSH ä¿®å¤ï¼Œè°ƒç”¨ `/fix/openwrt_reboot`ã€‚

---
